{% extends 'base.html.twig' %}

{% block title %}Authors Page{% endblock %}

{% block body %}
    {% if err %}
        <h1>{{ err }}</h1>
    {% else %}
        <h1>Authors List</h1>

        <p>
            Total results: {{ total_results }} |
            Page {{ current_page }} of {{ total_pages }}
        </p>

        {# Search & Sorting form #}
        <form method="get" class="authors-form">
            <label for="query">Search:</label>
            <input type="text" id="query" name="query" value="{{ query }}" maxlength="50" placeholder="Enter search term">

            <label for="direction">Direction:</label>
            <select name="direction" id="direction">
                <option value="ASC" {% if direction == 'ASC' %}selected{% endif %}>Ascending</option>
                <option value="DESC" {% if direction == 'DESC' %}selected{% endif %}>Descending</option>
            </select>

            <button type="submit">Search</button>
        </form>

        {# Previous & Next page links #}
        <div class="pagination">
            {% if show_previous_page %}
                <a href="{{ path('get_authors_page', {
                    page: current_page - 1,
                    query: query,
                    direction: direction,
                    orderBy: orderBy
                }) }}">Previous</a>
            {% endif %}

            {% if show_next_page %}
                <a href="{{ path('get_authors_page', {
                    page: current_page + 1,
                    query: query,
                    direction: direction,
                    orderBy: orderBy
                }) }}">Next</a>
            {% endif %}
        </div>

        {# Table of authors #}
        <table class="authors-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for author in authors %}
                    <tr>
                        <td>{{ author.id }}</td>
                        <td>{{ author.first_name }}</td>
                        <td>{{ author.last_name }}</td>
                        <td><a href="{{ path('get_single_author_page', {id: author.id}) }}">See Details</a></td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="4">No authors found.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <style>
        .authors-form {
            margin-bottom: 15px;
        }

        .authors-form input,
        .authors-form select,
        .authors-form button {
            margin-right: 5px;
            padding: 4px 6px;
        }

        .pagination {
            margin-bottom: 10px;
        }

        .pagination a {
            margin-right: 10px;
            text-decoration: none;
            color: #007BFF;
        }

        .pagination a:hover {
            text-decoration: underline;
        }

        .authors-table {
            width: 100%;
            border-collapse: collapse;
        }

        .authors-table th,
        .authors-table td {
            border: 1px solid #ccc;
            padding: 5px 8px;
            text-align: left;
        }

        .authors-table th {
            background-color: #f0f0f0;
        }
    </style>
{% endblock %}
